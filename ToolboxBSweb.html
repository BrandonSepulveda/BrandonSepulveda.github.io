<!DOCTYPE html>
<html lang="es">
<head>
    <link rel="icon" type="image/png" href="https://github.com/BrandonSepulveda/BrandonSepulveda.github.io/blob/main/logo/BS%20ToolBox-03.png?raw=true">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToolboxBS - Web UI</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9012803289038112" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2RY7LG5R21"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-2RY7LG5R21');
    </script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- Paleta de Colores Mejorada y Dinámica --- */
        :root {
            /* Color de acento por defecto, será sobreescrito por el selector de color */
            --accent-color: #3b82f6; /* Azul Eléctrico */
            --accent-dark: #2563eb;  /* Azul más oscuro para hover */

            --bg-color: #0D1117;
            --surface-color: #161B22;
            --surface-hover: #21262D;
            --border-color: #30363D;
            --border-hover: #8B949E;
            --text-primary: #E6EDF3;
            --text-secondary: #8B949E;
            --font-family: 'Inter', sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-family);
            background-color: var(--bg-color);
            color: var(--text-primary);
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* --- Header Mejorado --- */
        .header {
            background: rgba(13, 17, 23, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background-image: url('https://github.com/BrandonSepulveda/BrandonSepulveda.github.io/blob/main/logo/BS%20ToolBox-03.png?raw=true');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            filter: drop-shadow(0 0 10px var(--accent-color)); /* Sombra con color de acento */
            transition: filter 0.3s ease;
        }
        .logo-icon:hover {
            filter: drop-shadow(0 0 15px var(--accent-color));
        }

        .logo-text h1 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .logo-text p {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .nav {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .nav a, .window-btn {
            position: relative;
        }
        
        .nav a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: color 0.3s ease;
            padding: 5px 0;
        }

        .nav a:hover {
            color: var(--accent-color);
        }

        /* --- Selector de Color --- */
        .color-picker-wrapper {
            position: relative;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .color-picker-wrapper label {
            color: var(--text-secondary);
            font-size: 1.2rem;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        .color-picker-wrapper label:hover {
            color: var(--accent-color);
        }
        #colorPicker {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            width: 28px;
            height: 28px;
            background-color: transparent;
            border: none;
            cursor: pointer;
        }
        #colorPicker::-webkit-color-swatch {
            border-radius: 50%;
            border: 2px solid var(--border-color);
            transition: border-color 0.3s ease;
        }
        #colorPicker::-webkit-color-swatch:hover {
             border-color: var(--accent-color);
        }
        #colorPicker::-moz-color-swatch {
            border-radius: 50%;
            border: 2px solid var(--border-color);
        }

        .window-controls {
            display: flex;
            gap: 0.5rem;
        }

        .window-btn {
            width: 30px;
            height: 30px;
            background: transparent;
            border-radius: 50%;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1rem;
            transition: background 0.3s ease, color 0.3s ease;
        }

        .window-btn:hover {
            background: var(--surface-hover);
            color: var(--text-primary);
        }

        /* --- Contenido Principal Mejorado --- */
        .main-content {
            padding: 4rem 2rem;
            text-align: center;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .page-title {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 700;
            margin-bottom: 1.5rem;
            color: var(--text-primary);
            letter-spacing: -0.05em;
        }
        .page-title span {
            color: var(--accent-color);
        }
        
        .page-subtitle {
            font-size: 1.125rem;
            font-weight: 400;
            margin-bottom: 4rem;
            color: var(--text-secondary);
            max-width: 600px;
            line-height: 1.6;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            max-width: 1100px;
            width: 100%;
            margin: 0 auto;
        }

        .tool-card {
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 2rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            text-align: left;
        }

        .tool-card:hover {
            transform: translateY(-8px);
            border-color: var(--accent-color);
            box-shadow: 0 0 25px rgba(0,0,0,0.3), 0 0 15px var(--accent-color-trans);
        }

        .tool-icon {
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
            color: var(--accent-color);
            display: flex;
            justify-content: flex-start;
            align-items: center;
        }
        .tool-icon svg {
            width: 40px;
            height: 40px;
            stroke-width: 1.5;
        }

        .tool-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .tool-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }
        
        /* --- Tooltip Mejorado --- */
        .tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(10px);
            background-color: #000;
            color: #fff;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 500;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, transform 0.2s ease;
            pointer-events: none;
            z-index: 10;
            margin-bottom: 8px;
        }

        [onclick]:hover .tooltip, .nav a:hover .tooltip, .window-btn:hover .tooltip, .color-picker-wrapper:hover .tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(0);
        }

        /* --- Modal Mejorado --- */
        .modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            display: none; justify-content: center; align-items: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .modal-content {
            background: var(--bg-color);
            border-radius: 24px;
            padding: 2.5rem;
            max-width: 700px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            border: 1px solid var(--border-color);
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
            animation: scaleUp 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }

        @keyframes scaleUp { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .modal-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--accent-color);
            letter-spacing: -0.03em;
        }

        .close-btn {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 1.75rem;
            cursor: pointer;
            padding: 5px;
            transition: color 0.3s, transform 0.3s;
            line-height: 1;
        }

        .close-btn:hover {
            color: var(--accent-color);
            transform: rotate(90deg);
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
            margin-bottom: 2rem;
            text-align: left;
            font-weight: 400;
        }

        .tool-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .tool-item {
            background: transparent;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            transition: all 0.2s ease;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .tool-item:hover {
            background: var(--surface-hover);
            border-color: var(--border-hover);
            transform: translateY(-2px);
        }

        .tool-item.selected {
            background: var(--surface-color);
            border-color: var(--accent-color);
            box-shadow: 0 0 15px var(--accent-color-trans);
        }

        .tool-item-content {
            display: flex;
            align-items: center;
            gap: 1.25rem;
            flex: 1;
        }

        .tool-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            background: transparent;
            position: relative;
            transition: all 0.2s ease;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tool-item.selected .tool-checkbox, .tool-checkbox.checked {
            background: var(--accent-color);
            border-color: var(--accent-color);
        }

        .tool-checkbox.checked::after {
            content: '✔';
            font-size: 16px;
            color: var(--bg-color);
            font-weight: bold;
        }

        .tool-item-text {
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-primary);
            flex: 1;
        }

        .tool-item-arrow {
            color: var(--text-secondary);
            font-size: 1.5rem;
            margin-left: 1rem;
            transition: transform 0.3s;
        }
        .tool-item:hover .tool-item-arrow {
            transform: translateX(5px);
        }

        /* --- FAB Mejorado --- */
        .fab-container {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 1000;
        }

        .fab {
            background: var(--accent-color);
            border: none;
            border-radius: 50%;
            width: 64px;
            height: 64px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000; /* Color de texto oscuro para contraste */
            cursor: pointer;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3), 0 0 20px var(--accent-color-trans);
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            text-decoration: none;
            position: relative;
        }

        .fab:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4), 0 0 30px var(--accent-color-trans);
        }
        
        .fab:disabled {
            background: var(--surface-hover);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            color: var(--text-secondary);
        }
        
        .fab-icon {
            font-size: 1.75rem;
            transition: transform 0.4s ease;
        }
        .fab-icon svg {
            width: 28px;
            height: 28px;
        }
        
        .fab:hover:not(:disabled) .fab-icon {
            transform: rotate(180deg);
        }

        .fab #fabText {
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }

        .fab-count {
            font-size: 1rem;
            font-weight: 700;
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--bg-color);
            color: var(--accent-color);
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid var(--accent-color);
            transform: scale(0);
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        
        .fab:not(:disabled) .fab-count {
           transform: scale(1);
        }

        /* --- Cajas de Mensajes y Código --- */
        .message-box, .code-display-box {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            display: none; justify-content: center; align-items: center;
            z-index: 1001;
            animation: fadeIn 0.3s ease;
        }

        .message-box .modal-content, .code-display-box .modal-content {
            border: 1px solid var(--accent-color);
            box-shadow: 0 0 40px var(--accent-color-trans);
        }
        
        .message-box p {
            font-size: 1rem;
            margin-bottom: 2rem;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .message-box button, .code-display-box .actions button {
            background: var(--accent-color);
            border: 1px solid var(--accent-color);
            border-radius: 8px;
            padding: 12px 25px;
            color: #000;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: var(--font-family);
            font-size: 0.9rem;
        }

        .message-box button:hover, .code-display-box .actions button:hover {
            background: transparent;
            color: var(--accent-color);
        }

        .code-display-box .modal-content {
            display: flex;
            flex-direction: column;
            max-width: 800px;
        }

        .code-display-box pre {
            background-color: var(--bg-color);
            color: #f0f0f0;
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            overflow-x: auto;
            margin-top: 1rem;
            margin-bottom: 2rem;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9rem;
            text-align: left;
            white-space: pre-wrap;
            word-wrap: break-word;
            flex-grow: 1;
            max-height: 50vh;
        }

        .code-display-box .actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .code-display-box .actions .copy-btn {
            background: var(--surface-hover);
            border-color: var(--border-color);
            color: var(--text-primary);
        }
        .code-display-box .actions .copy-btn:hover {
            background: var(--surface-color);
            border-color: var(--border-hover);
            color: var(--accent-color);
        }

        /* --- Estilos del Modal "Sobre" --- */
        #about-modal .modal-content {
            text-align: center;
        }
        #about-modal img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin-bottom: 1.5rem;
            border: 2px solid var(--border-color);
        }
        #about-modal .info-section {
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            text-align: left;
        }
        #about-modal .info-section p {
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        #about-modal .info-section p strong {
            color: var(--text-primary);
            font-weight: 600;
        }
        #about-modal .info-section a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }
        #about-modal .info-section a:hover {
            text-decoration: underline;
            color: var(--accent-color);
        }

        /* --- Diseño Responsivo --- */
        @media (max-width: 768px) {
            .nav {
                display: none;
            }
            .page-title {
                font-size: 2.5rem;
            }
            .page-subtitle {
                font-size: 1rem;
            }
            .tools-grid {
                grid-template-columns: 1fr;
            }
            .modal-content {
                margin: 1rem;
                width: calc(100% - 2rem);
                padding: 1.5rem;
            }
            .fab-container {
                bottom: 1rem;
                right: 1rem;
            }
            .fab {
                width: 56px;
                height: 56px;
            }
            .fab-icon svg {
                width: 24px;
                height: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">
            <div class="logo-icon"></div>
            <div class="logo-text">
                <h1>TOOLBOXBS</h1>
                <p>By: Brandon Sepulveda</p>
            </div>
        </div>
        <nav class="nav">
            <div class="color-picker-wrapper">
                <label for="colorPicker" title="Cambiar color de acento">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"></path></svg>
                </label>
                <input type="color" id="colorPicker" value="#3b82f6">
                <div class="tooltip">Cambiar Acento</div>
            </div>
            <a href="#" onclick="openModal('home-modal')">Inicio<div class="tooltip">Menú Principal</div></a>
            <a href="#" onclick="openModal('tools-modal')">Herramientas<div class="tooltip">Ver todas las herramientas</div></a>
            <a href="#" onclick="openModal('about-modal')">Sobre<div class="tooltip">Información de la App</div></a>
            <a href="#" onclick="openExternalLink('https://brandonsepulveda.github.io/Documentacion.html')">Documentación<div class="tooltip">Abrir documentación en web</div></a>
        </nav>
        <div class="window-controls">
            <button class="window-btn">–<div class="tooltip">Minimizar</div></button>
            <button class="window-btn">□<div class="tooltip">Maximizar</div></button>
            <button class="window-btn">✕<div class="tooltip">Cerrar</div></button>
        </div>
    </div>

    <div class="main-content" id="mainContent">
        <h1 class="page-title">Tu Caja de Herramientas <span>Digital</span></h1>
        <p class="page-subtitle">Selecciona una categoría para acceder a las utilidades de optimización, reparación y configuración para tu sistema.</p>
        <div class="tools-grid">
            <div class="tool-card" onclick="openModal('info-modal')">
                <div class="tool-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"></rect><line x1="7" y1="2" x2="7" y2="22"></line><line x1="17" y1="2" x2="17" y2="22"></line><line x1="2" y1="12" x2="22" y2="12"></line><line x1="2" y1="7" x2="7" y2="7"></line><line x1="2" y1="17" x2="7" y2="17"></line><line x1="17" y1="17" x2="22" y2="17"></line><line x1="17" y1="7" x2="22" y2="7"></line></svg>
                </div>
                <div class="tool-title">Info. Sistema</div>
                <div class="tool-description">Datos del hardware y software.</div>
                <div class="tooltip">Ver detalles del sistema</div>
            </div>
            <div class="tool-card" onclick="openExternalLink('https://brandonsepulveda.github.io/apps.html')">
                <div class="tool-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                </div>
                <h3 class="tool-title">Descargas Apps</h3>
                <p class="tool-description">Abre nuestro centro de aplicaciones.</p>
                <div class="tooltip">Acceder al centro de aplicaciones</div>
            </div>
            <div class="tool-card" onclick="openModal('repair-modal')">
                <div class="tool-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path></svg>
                </div>
                <div class="tool-title">Reparación</div>
                <div class="tool-description">Verificación y reparación del sistema.</div>
                <div class="tooltip">Ejecutar herramientas de reparación</div>
            </div>
            <div class="tool-card" onclick="openModal('tweaks-modal')">
                <div class="tool-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                </div>
                <div class="tool-title">Tweaks</div>
                <div class="tool-description">Utilidades para optimización.</div>
                <div class="tooltip">Aplicar optimizaciones al sistema</div>
            </div>
        </div>
    </div>

    <div class="fab-container">
        <button class="fab" id="fabButton" onclick="showGeneratedCode()" disabled>
            <span class="fab-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>
            </span>
            <span id="fabText" style="font-weight: 700; display: block;">GENERAR</span>
            <span class="fab-count" id="fabCount" style="transform: scale(0);">0</span>
        </button>
    </div>

    <div id="info-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">INFORMACIÓN DEL SISTEMA</h2>
                <button class="close-btn" onclick="closeModal('info-modal')">✕</button>
            </div>
            <div class="subtitle">Selecciona la información que deseas ver</div>
            <div class="tool-list">
                <div class="tool-item" onclick="toggleSelection(this, 'info-hardware', 'info')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Generar Informe Completo del Sistema</span>
                    </div>
                    <div class="tooltip">Muestra un diagnóstico detallado de CPU, GPU, RAM, red y más.</div>
                </div>
            </div>
        </div>
    </div>

    <div id="repair-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">REPARACIÓN Y MANTENIMIENTO</h2>
                <button class="close-btn" onclick="closeModal('repair-modal')">✕</button>
            </div>
            <div class="subtitle">Selecciona una herramienta</div>
            <div class="tool-list">
                <div class="tool-item" onclick="toggleSelection(this, 'create-restore-point', 'repair')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Crear Punto de Restauración del Sistema</span>
                    </div>
                    <div class="tooltip">Crea un punto de guardado para revertir cambios si es necesario. (Recomendado)</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'os-maintenance', 'repair')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Mantenimiento de Archivos del Sistema (SFC & DISM)</span>
                    </div>
                    <div class="tooltip">Ejecuta SFC y DISM para buscar y reparar archivos corruptos de Windows.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'bsod-info', 'repair')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Analizar Errores de Pantalla Azul (BSOD)</span>
                    </div>
                    <div class="tooltip">Utiliza BlueScreenView para analizar los archivos de volcado de memoria.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'battery-status', 'repair')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Generar Informe de Estado de la Batería</span>
                    </div>
                    <div class="tooltip">Crea un informe detallado sobre la salud y ciclos de la batería.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'driver-info', 'repair')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Consultar Controladores del Sistema</span>
                    </div>
                    <div class="tooltip">Abre el Administrador de Dispositivos y genera un listado de drivers.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'repair-network', 'repair')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Restablecer Configuración de Red</span>
                    </div>
                    <div class="tooltip">Ejecuta una serie de comandos para solucionar problemas de conexión a internet.</div>
                </div>
                <div class="tool-item" onclick="openModal('cleanup-sub-modal')">
                    <div class="tool-item-content">
                        <span class="tool-item-text">Herramientas de Limpieza del Sistema</span>
                    </div>
                    <span class="tool-item-arrow">→</span>
                    <div class="tooltip">Accede a opciones para liberar espacio en disco y optimizar la memoria RAM.</div>
                </div>
            </div>
        </div>
    </div>

    <div id="tweaks-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">MEJORAS Y UTILIDADES</h2>
                <button class="close-btn" onclick="closeModal('tweaks-modal')">✕</button>
            </div>
            <div class="subtitle">Selecciona una utilidad</div>
            <div class="tool-list">
                <div class="tool-item" onclick="toggleSelection(this, 'winutil', 'tweaks')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Ejecutar Chris Titus Tech Windows Utility</span>
                    </div>
                    <div class="tooltip">Abre la popular herramienta de optimización y configuración de Chris Titus.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'tools-optimize-system', 'tweaks')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Aplicar Optimizaciones de Rendimiento</span>
                    </div>
                    <div class="tooltip">Ejecuta un script .bat con ajustes para mejorar la respuesta del sistema.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'activate-windows', 'tweaks')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Activar Windows con Clave de Firmware</span>
                    </div>
                    <div class="tooltip">Intenta activar Windows utilizando la clave de producto digital almacenada en la BIOS/UEFI.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'find-drivers', 'tweaks')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Buscar Controladores del Fabricante</span>
                    </div>
                    <div class="tooltip">Detecta el fabricante (Dell, HP, Lenovo) e instala su asistente de actualizaciones.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'update-apps', 'tweaks')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Actualizar Todas las Aplicaciones (Winget)</span>
                    </div>
                    <div class="tooltip">Busca y actualiza todas las aplicaciones instaladas a través de Winget.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'system-properties', 'tweaks')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Abrir Propiedades Avanzadas del Sistema</span>
                    </div>
                    <div class="tooltip">Accede a la configuración de rendimiento, perfiles de usuario y variables de entorno.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'disable-transparency', 'tweaks')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Deshabilitar Efectos de Transparencia</span>
                    </div>
                    <div class="tooltip">Desactiva la transparencia de la interfaz para mejorar el rendimiento gráfico.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'reboot-bios', 'tweaks')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Reiniciar el Equipo en la BIOS/UEFI</span>
                    </div>
                    <div class="tooltip">Reinicia el PC y accede directamente a la configuración del firmware.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'recovery-env', 'tweaks')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Acceder al Entorno de Recuperación</span>
                    </div>
                    <div class="tooltip">Reinicia en el modo de recuperación de Windows para opciones avanzadas.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'install-winget', 'tweaks')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Instalar Gestor de Paquetes Winget</span>
                    </div>
                    <div class="tooltip">Abre la Microsoft Store para instalar el gestor de paquetes oficial de Microsoft.</div>
                </div>
            </div>
        </div>
    </div>

    <div id="cleanup-sub-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">OPCIONES DE LIMPIEZA</h2>
                <button class="close-btn" onclick="closeModal('cleanup-sub-modal')">✕</button>
            </div>
            <div class="subtitle">Selecciona las opciones de limpieza</div>
            <div class="tool-list">
                <div class="tool-item" onclick="toggleSelection(this, 'cleanup-temp-files', 'repairCleanup')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Limpiar Archivos Temporales</span>
                    </div>
                    <div class="tooltip">Elimina de forma segura los archivos temporales de Windows y del perfil de usuario.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'cleanup-optimize-ram', 'repairCleanup')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Liberar y Optimizar Memoria RAM</span>
                    </div>
                    <div class="tooltip">Utiliza RAMMap de Sysinternals para limpiar áreas de la memoria RAM.</div>
                </div>
            </div>
        </div>
    </div>

    <div id="messageBox" class="message-box">
        <div class="modal-content" style="max-width: 450px; text-align: center;">
            <p id="messageText"></p>
            <button onclick="hideMessageBox()">Cerrar</button>
        </div>
    </div>
    
    <div id="codeDisplayBox" class="code-display-box">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Script Generado</h2>
                <button class="close-btn" onclick="closeModal('codeDisplayBox')">✕</button>
            </div>
            <pre id="codeContent"></pre>
            <div class="actions">
                <button class="copy-btn" onclick="copyCodeFromDisplay()">Copiar Código</button>
                <button class="download-btn" onclick="downloadZipFromDisplay()">Descargar ZIP</button>
            </div>
        </div>
    </div>

    <div id="home-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">MENÚ DE INICIO</h2>
                <button class="close-btn" onclick="closeModal('home-modal')">✕</button>
            </div>
            <div class="subtitle">Accesos rápidos y herramientas esenciales</div>
            <div class="tool-list">
                <div class="tool-item" onclick="toggleSelection(this, 'home-control-panel', 'home')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Panel de Control</span>
                    </div>
                    <div class="tooltip">Abre el Panel de Control clásico de Windows.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'home-windows-settings', 'home')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Configuración de Windows</span>
                    </div>
                    <div class="tooltip">Abre la aplicación moderna de Configuración de Windows.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'home-file-explorer', 'home')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Explorador de Archivos</span>
                    </div>
                    <div class="tooltip">Abre una nueva ventana del Explorador de Archivos.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'home-system-info-app', 'home')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Información del Sistema (msinfo32)</span>
                    </div>
                    <div class="tooltip">Abre la utilidad de Información del Sistema para ver detalles de hardware.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'home-powershell-console', 'home')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Nueva Consola de PowerShell</span>
                    </div>
                    <div class="tooltip">Inicia una nueva instancia de la terminal de PowerShell.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'home-quick-diagnostic', 'home')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Realizar Diagnóstico Rápido</span>
                    </div>
                    <div class="tooltip">Muestra información básica del sistema directamente en la consola.</div>
                </div>
            </div>
        </div>
    </div>

    <div id="tools-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">MENÚ DE HERRAMIENTAS</h2>
                <button class="close-btn" onclick="closeModal('tools-modal')">✕</button>
            </div>
            <div class="subtitle">Todas las herramientas de optimización y reparación</div>
            <div class="tool-list">
                 <div class="tool-item" onclick="toggleSelection(this, 'tools-task-manager', 'tools')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Administrador de Tareas</span>
                    </div>
                    <div class="tooltip">Abre el Administrador de Tareas para gestionar procesos y rendimiento.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'tools-device-manager', 'tools')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Administrador de Dispositivos</span>
                    </div>
                    <div class="tooltip">Gestiona los controladores y el hardware del sistema.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'tools-windows-services', 'tools')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Servicios de Windows</span>
                    </div>
                    <div class="tooltip">Administra los servicios que se ejecutan en segundo plano.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'tools-disk-cleanup', 'tools')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Liberador de Espacio en Disco</span>
                    </div>
                    <div class="tooltip">Abre la herramienta nativa para eliminar archivos innecesarios.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'tools-registry-editor', 'tools')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Editor del Registro</span>
                    </div>
                    <div class="tooltip">Abre regedit.exe (úselo con precaución).</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'tools-winget-cli', 'tools')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Consola de Winget</span>
                    </div>
                    <div class="tooltip">Abre PowerShell listo para usar comandos de Winget.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'tools-check-updates', 'tools')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Buscar Actualizaciones de Windows</span>
                    </div>
                    <div class="tooltip">Abre la sección de Windows Update en la Configuración.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'tools-windows-repair', 'tools')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Reparación Básica de Windows</span>
                    </div>
                    <div class="tooltip">Ejecuta los comandos SFC y DISM para reparar archivos del sistema.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'tools-download-windows', 'tools')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Asistente para Descargar ISO de Windows</span>
                    </div>
                    <div class="tooltip">Abre una herramienta para descargar imágenes oficiales de Windows.</div>
                </div>
                <div class="tool-item" onclick="toggleSelection(this, 'tools-install-windows', 'tools')">
                    <div class="tool-item-content">
                        <div class="tool-checkbox"></div>
                        <span class="tool-item-text">Asistente para Instalación de Windows (Windeploy)</span>
                    </div>
                    <div class="tooltip">Abre una herramienta para formatear e instalar el sistema operativo.</div>
                </div>
            </div>
        </div>
    </div>

    <div id="about-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">SOBRE TOOLBOXBS</h2>
                <button class="close-btn" onclick="closeModal('about-modal')">✕</button>
            </div>
            <img src="https://github.com/BrandonSepulveda/BrandonSepulveda.github.io/blob/main/logo/BS%20ToolBox-03.png?raw=true" alt="Logo de ToolboxBS">
            <h3 style="font-size: 1.5rem; color: #fff; margin-bottom: 10px;">ToolboxBS v2.7</h3>
            <p style="font-size: 1rem; color: var(--text-secondary); line-height: 1.6; max-width: 500px; margin: 0 auto 30px auto;">
                Una colección de herramientas curadas para optimizar, reparar y personalizar tu sistema Windows de forma sencilla y potente.
            </p>
            <div class="info-section">
                <p><strong>Autor:</strong> Jhon Brandon Sepulveda Valdes</p>
                <p><strong>GitHub:</strong> <a href="https://github.com/BrandonSepulveda/ToolboxBS" target="_blank">BrandonSepulveda/ToolboxBS</a></p>
            </div>
            <div class="info-section">
                <p><strong>Licencia:</strong> GNU AGPL v3.0 - Copyright (c) 2024-2025 Jhon Brandon Sepulveda Valdes</p>
            </div>
        </div>
    </div>

    <script>
        // ==================================================================
        // INICIO DE LA LÓGICA DE LA APLICACIÓN
        // ==================================================================

        // Objeto para almacenar las herramientas seleccionadas por categoría
        let selectedTools = {
            'info': [],
            'repair': [],
            'repairCleanup': [], // Sub-category for cleanup options
            'tweaks': [],
            'home': [],
            'tools': []
        };
        
        // Variables globales para almacenar el contenido de los archivos generados
        let currentPs1Content = '';
        let currentBatContent = '';

        // Comandos de PowerShell (Sincronizados con ToolboxBS v2.7)
        const powershellCommands = {
            'info-hardware': `
#======================================================================
# SystemInfoPlus.ps1
# Script avanzado para recopilación detallada de información del sistema
# Compatible con PowerShell 5.1 y superior
#======================================================================

Clear-Host
$ErrorActionPreference = 'SilentlyContinue'
$WarningPreference = 'SilentlyContinue'

# Función para crear encabezados con estilo
function Write-ColorHeader {
    param (
        [string]$Text,
        [string]$ForegroundColor = 'Cyan'
    )
    $width = $host.UI.RawUI.WindowSize.Width - 4
    $line = "=" * $width
    Write-Host ""
    Write-Host $line -ForegroundColor $ForegroundColor
    Write-Host "  $Text" -ForegroundColor $ForegroundColor
    Write-Host $line -ForegroundColor $ForegroundColor
}

# Función para mostrar información con formato
function Write-InfoLine {
    param (
        [string]$Label,
        $Value,
        [string]$ValueColor = 'White'
    )
    $LabelWidth = 30
    $formattedLabel = $Label.PadRight($LabelWidth, ".")
    Write-Host " $formattedLabel" -NoNewline -ForegroundColor 'DarkGray'
    Write-Host " $Value" -ForegroundColor $ValueColor
}

# Función para crear una barra de progreso visual
function Write-ProgressBar {
    param (
        [int]$Percentage,
        [int]$BarSize = 25,
        [string]$BarColor = 'Green',
        [string]$EmptyColor = 'DarkGray'
    )
    $completedSize = [math]::Floor(($Percentage / 100) * $BarSize)
    $remainingSize = $BarSize - $completedSize
    Write-Host " [" -NoNewline
    Write-Host ("■" * $completedSize) -NoNewline -ForegroundColor $BarColor
    Write-Host ("□" * $remainingSize) -NoNewline -ForegroundColor $EmptyColor
    Write-Host "] $Percentage%" -ForegroundColor 'DarkGray'
}

# Función para convertir bytes a formato legible
function Convert-Size {
    param(
        [double]$SizeInBytes
    )
    if ($SizeInBytes -lt 1KB) { return "$SizeInBytes B" }
    elseif ($SizeInBytes -lt 1MB) { return "{0:N2} KB" -f ($SizeInBytes / 1KB) }
    elseif ($SizeInBytes -lt 1GB) { return "{0:N2} MB" -f ($SizeInBytes / 1MB) }
    elseif ($SizeInBytes -lt 1TB) { return "{0:N2} GB" -f ($SizeInBytes / 1GB) }
    else { return "{0:N2} TB" -f ($SizeInBytes / 1TB) }
}

# Obtener información detallada de instalación
function Get-WindowsInstallDetails {
    try {
        $installTime = (Get-ItemProperty "HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion").InstallTime
        $installDate = [DateTime]::FromFileTime([Int64]::Parse($installTime))
        $detailedInstallInfo = Get-ItemProperty "HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion" -ErrorAction SilentlyContinue
        [PSCustomObject]@{
            InstallDate = $installDate
            InstallTime = $installDate.ToString("HH:mm:ss")
            DaysSinceInstall = [math]::Round(((Get-Date) - $installDate).TotalDays, 0)
            ReleaseId = $detailedInstallInfo.ReleaseId
            ProductName = $detailedInstallInfo.ProductName
            EditionID = $detailedInstallInfo.EditionID
            BuildBranch = $detailedInstallInfo.BuildBranch
            CurrentBuild = $detailedInstallInfo.CurrentBuild
        }
    }
    catch {
        try {
            $OS = Get-CimInstance Win32_OperatingSystem
            $installDate = [System.Management.ManagementDateTimeConverter]::ToDateTime($OS.InstallDate)
            [PSCustomObject]@{
                InstallDate = $installDate
                InstallTime = $installDate.ToString("HH:mm:ss")
                DaysSinceInstall = [math]::Round(((Get-Date) - $installDate).TotalDays, 0)
                ReleaseId = "Desconocido"
                ProductName = $OS.Caption
                EditionID = "Desconocido"
                BuildBranch = "Desconocido"
                CurrentBuild = $OS.BuildNumber
            }
        }
        catch {
            $installDate = Get-Date
            [PSCustomObject]@{
                InstallDate = $installDate
                InstallTime = $installDate.ToString("HH:mm:ss")
                DaysSinceInstall = 0
                ReleaseId = "Desconocido"
                ProductName = "Desconocido"
                EditionID = "Desconocido"
                BuildBranch = "Desconocido"
                CurrentBuild = "Desconocido"
            }
        }
    }
}
$installInfo = Get-WindowsInstallDetails

Write-Host "\`n\`n" -NoNewline
$progressChars = @("/", "-", "\\", "|")
foreach ($i in 1..15) {
    $char = $progressChars[$i % 4]
    Write-Host "\`r $char Cargando sistema de diagnóstico avanzado... $($i * 6)%" -NoNewline -ForegroundColor 'Yellow'
    Start-Sleep -Milliseconds 100
}
Write-Host "\`r √ Sistema de diagnóstico cargado completamente.    " -ForegroundColor 'Green'
Start-Sleep -Milliseconds 500
Clear-Host
$title = @"
================================================================================
 _____           _                _____         __      _____ _          
/  ___|         | |              |_   _|       / _|    |  __ \\| |         
\\ \`--.  _  _ __| |_ ___ _ __ ___  | | _ __   | |_ ___  | |  \\/| |  _ ___ 
 \`--. \\| | | / _\` | / _ \\ '_ \` _ \\| || '_ \\  |  _/ _ \\ | | __| | | | / __|
/\\__/ /| |_| \\__,_|  __/ | | | | | || | | || || (_) || |_\\ \\ | |_| \\__ \\
\\____/  \\__, |\\__,_|\\___|_| |_| |_\\___|_| |_||_| \\___/  \\____/_|\\__,_|___/
         __/ |                                                         
        |___/        Diagnóstico Avanzado v2.0 Complemento ToolboxBS by: Brandon Sepulveda
================================================================================
"@
Write-Host $title -ForegroundColor 'Cyan'
Write-Host ' Ejecutando diagnóstico completo del sistema...' -ForegroundColor 'Yellow'
Write-Host ' Fecha de ejecución: $(Get-Date -Format 'dd/MM/yyyy HH:mm:ss')\`n' -ForegroundColor 'Gray'
#========================================
# INFORMACIÓN DEL SISTEMA OPERATIVO
#========================================
Write-ColorHeader 'INFORMACIÓN DEL SISTEMA OPERATIVO'
$OS = Get-CimInstance Win32_OperatingSystem
$computerSystem = Get-CimInstance Win32_ComputerSystem
$bios = Get-CimInstance Win32_BIOS
Write-InfoLine 'Nombre del equipo' $env:COMPUTERNAME 'Yellow'
Write-InfoLine 'Usuario actual' "$env:USERDOMAIN\\$env:USERNAME" 'Yellow'
Write-InfoLine 'Sistema Operativo' $OS.Caption 'White'
Write-InfoLine 'Versión' $OS.Version 'White'
Write-InfoLine 'Build' $OS.BuildNumber 'White'
Write-InfoLine 'Arquitectura' "$($OS.OSArchitecture)" 'White'
Write-InfoLine 'Fecha de instalación' $installInfo.InstallDate.ToString("dd/MM/yyyy HH:mm:ss") 'Magenta'
Write-InfoLine 'Días desde instalación' "$($installInfo.DaysSinceInstall) días" 'Magenta'
try {
    $detailedInstallInfo = Get-ItemProperty "HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion" -ErrorAction SilentlyContinue
    if ($detailedInstallInfo.ReleaseId) {
        Write-InfoLine 'ID de versión' $detailedInstallInfo.ReleaseId 'White'
    }
    if ($detailedInstallInfo.BuildBranch) {
        Write-InfoLine 'Rama de compilación' $detailedInstallInfo.BuildBranch 'White'
    }
} catch {}
Write-InfoLine 'Último arranque' $OS.LastBootUpTime.ToString("dd/MM/yyyy HH:mm:ss") 'White'
$upTime = (Get-Date) - $OS.LastBootUpTime
Write-InfoLine 'Tiempo activo' "$($upTime.Days) días, $($upTime.Hours) horas, $($upTime.Minutes) minutos" 'Green'
Write-InfoLine 'Fabricante' $computerSystem.Manufacturer 'White'
Write-InfoLine 'Modelo' $computerSystem.Model 'White'
Write-InfoLine 'Número de serie BIOS' $bios.SerialNumber 'White'
#========================================
# INFORMACIÓN DEL PROCESADOR
#========================================
Write-ColorHeader 'INFORMACIÓN DEL PROCESADOR'
$processor = Get-CimInstance Win32_Processor
$cpuLoad = (Get-CimInstance Win32_Processor | Measure-Object -Property LoadPercentage -Average).Average
Write-InfoLine 'Procesador' $processor.Name 'White'
Write-InfoLine 'Fabricante' $processor.Manufacturer 'White'
Write-InfoLine 'Núcleos físicos' $processor.NumberOfCores 'White'
Write-InfoLine 'Núcleos lógicos' $processor.NumberOfLogicalProcessors 'White'
Write-InfoLine 'Velocidad actual' "$($processor.CurrentClockSpeed) MHz" 'White'
Write-InfoLine 'Velocidad máxima' "$($processor.MaxClockSpeed) MHz" 'White'
Write-InfoLine 'Socket' $processor.SocketDesignation 'White'
Write-InfoLine 'Arquitectura' $processor.Architecture 'White'
Write-InfoLine 'Caché L2' "$($processor.L2CacheSize) KB" 'White'
Write-InfoLine 'Caché L3' "$($processor.L3CacheSize) KB" 'White'
Write-Host ' Uso actual del CPU' -NoNewline -ForegroundColor 'DarkGray'
$cpuColor = if ($cpuLoad -lt 30) { 'Green' } elseif ($cpuLoad -lt 70) { 'Yellow' } else { 'Red' }
Write-ProgressBar -Percentage $cpuLoad -BarColor $cpuColor
#========================================
# INFORMACIÓN DE MEMORIA
#========================================
Write-ColorHeader 'INFORMACIÓN DE MEMORIA RAM'
$totalRAM = [math]::Round($computerSystem.TotalPhysicalMemory / 1GB, 2)
$availableRAM = [math]::Round((Get-CimInstance -ClassName Win32_OperatingSystem).FreePhysicalMemory / 1MB, 2)
$usedRAM = [math]::Round($totalRAM - $availableRAM, 2)
$ramUsagePercentage = [math]::Round(($usedRAM / $totalRAM) * 100, 0)
Write-InfoLine 'Memoria total instalada' "$totalRAM GB" 'White'
Write-InfoLine 'Memoria disponible' "$availableRAM GB" 'White'
Write-InfoLine 'Memoria en uso' "$usedRAM GB" 'White'
Write-Host ' Uso actual de memoria' -NoNewline -ForegroundColor 'DarkGray'
$ramColor = if ($ramUsagePercentage -lt 30) { 'Green' } elseif ($ramUsagePercentage -lt 70) { 'Yellow' } else { 'Red' }
Write-ProgressBar -Percentage $ramUsagePercentage -BarColor $ramColor
#========================================
# INFORMACIÓN DE ALMACENAMIENTO
#========================================
Write-ColorHeader 'INFORMACIÓN DE ALMACENAMIENTO'
$diskdrives = Get-CimInstance Win32_DiskDrive
$diskCounter = 1
foreach ($disk in $diskdrives) {
    $partitions = $disk | Get-CimAssociatedInstance -ResultClassName Win32_DiskPartition
    $diskSize = [math]::Round($disk.Size / 1GB, 2)
    $diskModel = $disk.Model
    $diskInterface = $disk.InterfaceType
    Write-Host "\`n Disco físico #$diskCounter" -ForegroundColor 'DarkCyan'
    Write-InfoLine "    Modelo" $diskModel "White"
    Write-InfoLine "    Tamaño" "$diskSize GB" "White"
    Write-InfoLine "    Interfaz" $diskInterface "White"
    Write-InfoLine "    Número de serie" $disk.SerialNumber "White"
    Write-InfoLine "    Particiones" $partitions.Count "White"
    $partitionCounter = 1
    foreach ($partition in $partitions) {
        $logicaldisks = $partition | Get-CimAssociatedInstance -ResultClassName Win32_LogicalDisk
        foreach ($logicaldisk in $logicaldisks) {
            $freeSpace = [math]::Round($logicaldisk.FreeSpace / 1GB, 2)
            $totalSize = [math]::Round($logicaldisk.Size / 1GB, 2)
            $usedSpace = [math]::Round($totalSize - $freeSpace, 2)
            $percentFree = [math]::Round(($freeSpace / $totalSize) * 100, 0)
            $percentUsed = 100 - $percentFree
            Write-Host "\`n     Volumen lógico" -ForegroundColor 'DarkYellow'
            Write-InfoLine "       Letra de unidad" "$($logicaldisk.DeviceID)" "Yellow"
            Write-InfoLine "       Etiqueta" "$($logicaldisk.VolumeName)" "White"
            Write-InfoLine "       Sistema de archivos" "$($logicaldisk.FileSystem)" "White"
            Write-InfoLine "       Tamaño total" "$totalSize GB" "White"
            Write-InfoLine "       Espacio usado" "$usedSpace GB" "White"
            Write-InfoLine "       Espacio libre" "$freeSpace GB" "White"
            Write-Host "       Uso del disco" -NoNewline -ForegroundColor 'DarkGray'
            $diskColor = if ($percentUsed -lt 70) { "Green" } elseif ($percentUsed -lt 90) { "Yellow" } else { "Red" }
            Write-ProgressBar -Percentage $percentUsed -BarColor $diskColor
            $partitionCounter++
        }
    }
    $diskCounter++
}
#========================================
# INFORMACIÓN DE TARJETA GRÁFICA
#========================================
Write-ColorHeader 'INFORMACIÓN DE TARJETA GRÁFICA'
$videoControllers = Get-CimInstance Win32_VideoController
$gpuCounter = 1
foreach ($gpu in $videoControllers) {
    Write-Host "\`n Tarjeta gráfica #$gpuCounter" -ForegroundColor 'DarkCyan'
    Write-InfoLine "    Nombre" $gpu.Name "White"
    Write-InfoLine "    Fabricante" $gpu.VideoProcessor "White"
    Write-InfoLine "    Versión de controlador" $gpu.DriverVersion "White"
    Write-InfoLine "    Fecha del controlador" ([System.Management.ManagementDateTimeConverter]::ToDateTime($gpu.DriverDate).ToString("dd/MM/yyyy")) "White"
    Write-InfoLine "    Resolución actual" "$($gpu.CurrentHorizontalResolution) x $($gpu.CurrentVerticalResolution)" "White"
    Write-InfoLine "    Frecuencia de refresco" "$($gpu.CurrentRefreshRate) Hz" "White"
    Write-InfoLine "    Memoria dedicada" "$(Convert-Size $gpu.AdapterRAM)" "White"
    $gpuCounter++
}
#========================================
# INFORMACIÓN DE RED
#========================================
Write-ColorHeader 'INFORMACIÓN DE RED'
$networkAdapters = Get-CimInstance Win32_NetworkAdapter | Where-Object { $_.PhysicalAdapter -eq $true -and $_.MACAddress -ne $null }
$adapterCounter = 1
foreach ($adapter in $networkAdapters) {
    $config = $adapter | Get-CimAssociatedInstance -ResultClassName Win32_NetworkAdapterConfiguration
    if ($config -ne $null) {
        Write-Host "\`n Adaptador de red #$adapterCounter" -ForegroundColor 'DarkCyan'
        Write-InfoLine "    Nombre" $adapter.Name "White"
        Write-InfoLine "    Fabricante" $adapter.Manufacturer "White"
        Write-InfoLine "    Tipo de adaptador" $adapter.AdapterType "White"
        Write-InfoLine "    Dirección MAC" $adapter.MACAddress "White"
        Write-InfoLine "    Velocidad" "$([math]::Round($adapter.Speed / 1000000, 0)) Mbps" "White"
        if ($config.IPAddress -ne $null) {
            Write-InfoLine "    Dirección IPv4" ($config.IPAddress | Where-Object { $_ -like "*.*" })[0] "White"
            Write-InfoLine "    Máscara de subred" $config.IPSubnet[0] "White"
            if ($config.DefaultIPGateway -ne $null) {
                Write-InfoLine "    Puerta de enlace" $config.DefaultIPGateway[0] "White"
            }
            if ($config.DNSServerSearchOrder -ne $null) {
                Write-InfoLine "    Servidor DNS primario" $config.DNSServerSearchOrder[0] "White"
                if ($config.DNSServerSearchOrder.Count -gt 1) {
                    Write-InfoLine "    Servidor DNS secundario" $config.DNSServerSearchOrder[1] "White"
                }
            }
        }
        Write-InfoLine "    Estado" $(if ($adapter.NetEnabled) { "Conectado" } else { "Desconectado" }) $(if ($adapter.NetEnabled) { "Green" } else { "Red" })
        $adapterCounter++
    }
}
$networkStats = Get-NetAdapterStatistics | Where-Object Status -eq "Up"
foreach ($stat in $networkStats) {
    $adapter = Get-NetAdapter | Where-Object InterfaceIndex -eq $stat.InterfaceIndex
    Write-Host "\`n Estadísticas de red: $($adapter.Name)" -ForegroundColor 'DarkCyan'
    Write-InfoLine "    Recibidos" "$(Convert-Size $stat.ReceivedBytes)" "White"
    Write-InfoLine "    Enviados" "$(Convert-Size $stat.SentBytes)" "White"
    Write-InfoLine "    Paquetes recibidos" $stat.ReceivedPackets "White"
    Write-InfoLine "    Paquetes enviados" $stat.SentPackets "White"
    Write-InfoLine "    Errores recibidos" $stat.ReceivedErrors "White"
    Write-InfoLine "    Errores enviados" $stat.SentErrors "White"
}
#========================================
# DISPOSITIVOS DE AUDIO
#========================================
Write-ColorHeader 'DISPOSITIVOS DE AUDIO'
$audioDevices = Get-CimInstance Win32_SoundDevice
$audioCounter = 1
foreach ($audio in $audioDevices) {
    Write-Host "\`n Dispositivo de audio #$audioCounter" -ForegroundColor 'DarkCyan'
    Write-InfoLine "    Nombre" $audio.Name "White"
    Write-InfoLine "    Fabricante" $audio.Manufacturer "White"
    Write-InfoLine "    Estado" $(if ($audio.Status -eq "OK") { "Funcionando correctamente" } else { $audio.Status }) $(if ($audio.Status -eq "OK") { "Green" } else { "Red" })
    $audioCounter++
}
#========================================
# SERVICIOS CRÍTICOS
#========================================
Write-ColorHeader 'SERVICIOS CRÍTICOS DEL SISTEMA'
$criticalServices = @(
    "wuauserv", "windefend", "WSearch", "Audiosrv", "bits", "EventLog", "LanmanServer", "LanmanWorkstation", "Dnscache", "Dhcp", "TabletInputService", "ShellHWDetection"
)
foreach ($service in $criticalServices) {
    $svc = Get-Service -Name $service -ErrorAction SilentlyContinue
    if ($svc -ne $null) {
        $status = $svc.Status
        $statusColor = if ($status -eq "Running") { "Green" } else { "Red" }
        Write-InfoLine "$($svc.DisplayName)" "$status" $statusColor
    }
}
#========================================
# ACTUALIZACIONES INSTALADAS
#========================================
Write-ColorHeader 'ÚLTIMAS ACTUALIZACIONES INSTALADAS'
$updates = Get-HotFix | Sort-Object -Property InstalledOn -Descending | Select-Object -First 10
foreach ($update in $updates) {
    Write-InfoLine "$($update.HotFixID)" "$($update.Description) - $($update.InstalledOn.ToString('dd/MM/yyyy'))" "White"
}
#========================================
# RESUMEN Y SALUD DEL SISTEMA
#========================================
Write-ColorHeader 'RESUMEN DE SALUD DEL SISTEMA'
try {
    $cpuLoad = (Get-CimInstance Win32_Processor | Measure-Object -Property LoadPercentage -Average).Average
    if ($cpuLoad -eq $null) { $cpuLoad = 50 }
    $cpuHealth = if ($cpuLoad -lt 50) { 100 } elseif ($cpuLoad -lt 80) { 70 } else { 40 }
    $totalRAM = [math]::Round((Get-CimInstance Win32_ComputerSystem).TotalPhysicalMemory / 1GB, 2)
    $availableRAM = [math]::Round((Get-CimInstance -ClassName Win32_OperatingSystem).FreePhysicalMemory / 1MB, 2)
    $usedRAM = [math]::Round($totalRAM - $availableRAM, 2)
    $ramUsagePercentage = [math]::Round(($usedRAM / $totalRAM) * 100, 0)
    $ramHealth = if ($ramUsagePercentage -lt 70) { 100 } elseif ($ramUsagePercentage -lt 90) { 60 } else { 30 }
    $systemDrive = Get-CimInstance Win32_LogicalDisk -Filter "DeviceID='$env:SystemDrive'"
    $diskFreePercent = [math]::Round(($systemDrive.FreeSpace / $systemDrive.Size) * 100, 0)
    $diskHealth = if ($diskFreePercent -gt 25) { 100 } elseif ($diskFreePercent -gt 10) { 60 } else { 20 }
    try {
        $updateSession = New-Object -ComObject Microsoft.Update.Session
        $updateSearcher = $updateSession.CreateUpdateSearcher()
        $searchResult = $updateSearcher.Search("IsInstalled=0 and Type='Software'")
        $pendingUpdates = $searchResult.Updates.Count
        $updateHealth = if ($pendingUpdates -eq 0) { 100 } elseif ($pendingUpdates -lt 5) { 80 } else { 60 }
    } catch {
        $updateHealth = 70
    }
    $overallHealth = [math]::Round(($cpuHealth + $ramHealth + $diskHealth + $updateHealth) / 4)
    $cpuColor = if ($cpuHealth -gt 75) { "Green" } elseif ($cpuHealth -gt 50) { "Yellow" } else { "Red" }
    $ramColor = if ($ramHealth -gt 75) { "Green" } elseif ($ramHealth -gt 50) { "Yellow" } else { "Red" }
    $diskColor = if ($diskHealth -gt 75) { "Green" } elseif ($diskHealth -gt 50) { "Yellow" } else { "Red" }
    $updateColor = if ($updateHealth -gt 75) { "Green" } elseif ($updateHealth -gt 50) { "Yellow" } else { "Red" }
    $healthColor = if ($overallHealth -gt 75) { "Green" } elseif ($overallHealth -gt 50) { "Yellow" } else { "Red" }
    Write-InfoLine "Salud del procesador" "$cpuHealth%" $cpuColor
    Write-InfoLine "Uso actual de CPU" "$cpuLoad%" $cpuColor
    Write-InfoLine "Salud de la memoria" "$ramHealth%" $ramColor
    Write-InfoLine "Uso actual de RAM" "$ramUsagePercentage%" $ramColor
    Write-InfoLine "Salud del almacenamiento" "$diskHealth%" $diskColor
    Write-InfoLine "Espacio libre en disco C:" "$diskFreePercent%" $diskColor
    Write-InfoLine "Estado de actualizaciones" "$updateHealth%" $updateColor
    Write-InfoLine "Actualizaciones pendientes" "$pendingUpdates" $updateColor
} catch {
    Write-Host " Error al calcular la salud del sistema: $_" -ForegroundColor "Red"
    Write-Host " Se mostrarán valores estimados" -ForegroundColor "Yellow"
    $cpuHealth = 70
    $ramHealth = 70
    $diskHealth = 70
    $updateHealth = 70
    $overallHealth = 70
    $healthColor = "Yellow"
    Write-InfoLine "Salud del procesador" "$cpuHealth% (estimado)" "Yellow"
    Write-InfoLine "Salud de la memoria" "$ramHealth% (estimado)" "Yellow"
    Write-InfoLine "Salud del almacenamiento" "$diskHealth% (estimado)" "Yellow"
    Write-InfoLine "Estado de actualizaciones" "$updateHealth% (estimado)" "Yellow"
}
Write-Host "\`n SALUD GENERAL DEL SISTEMA" -ForegroundColor "White"
Write-ProgressBar -Percentage $overallHealth -BarColor $healthColor -BarSize 50
Write-Host "\`n INDICADORES DE RENDIMIENTO" -ForegroundColor "Cyan"
Write-InfoLine "Rendimiento del procesador" "$(100 - $cpuLoad)%" $(if ((100 - $cpuLoad) -gt 75) { "Green" } elseif ((100 - $cpuLoad) -gt 50) { "Yellow" } else { "Red" })
Write-InfoLine "Eficiencia de memoria" "$(100 - $ramUsagePercentage)%" $(if ((100 - $ramUsagePercentage) -gt 75) { "Green" } elseif ((100 - $ramUsagePercentage) -gt 50) { "Yellow" } else { "Red" })
Write-InfoLine "Estado general" "$overallHealth%" $healthColor
Write-Host "\`n RECOMENDACIONES" -ForegroundColor "Cyan"
if ($cpuHealth -lt 75) { Write-Host " • Verifica los procesos que consumen más CPU con el Administrador de tareas" -ForegroundColor "Yellow" }
if ($ramHealth -lt 75) { Write-Host " • Considera cerrar aplicaciones para liberar memoria RAM" -ForegroundColor "Yellow" }
if ($diskHealth -lt 75) { Write-Host " • Ejecuta la herramienta de limpieza de disco para liberar espacio" -ForegroundColor "Yellow" }
if ($updateHealth -lt 90) { Write-Host " • Instala las actualizaciones pendientes del sistema" -ForegroundColor "Yellow" }
if ($overallHealth -lt 50) { Write-Host " • Se recomienda una revisión más detallada del sistema" -ForegroundColor "Red" }
Write-Host "\`n Gracias por utilizar SystemInfoPlus!" -ForegroundColor "Cyan"
Write-Host " Presiona cualquier tecla para salir..." -ForegroundColor "DarkGray"
$null = $Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")
`,
            'create-restore-point': `try { Checkpoint-Computer -Description "Punto de restauracion por ToolboxBS" } catch { Write-Host "Error al crear punto de restauracion: $_" -ForegroundColor Red }`,
            'os-maintenance': `sfc /scannow; DISM /Online /Cleanup-image /Restorehealth; Dism /Online /Cleanup-Image /startComponentCleanup`,
            'bsod-info': `
Write-Host "Abriendo BlueScreenView para analizar pantallazos azules..." -ForegroundColor Yellow
$Url = "https://www.nirsoft.net/utils/bluescreenview.zip"
$ZipPath = Join-Path $env:TEMP "bluescreenview.zip"
$ExtractPath = Join-Path $env:TEMP "BlueScreenView"
try { Invoke-WebRequest -Uri $Url -OutFile $ZipPath } catch { Write-Host "Error al descargar BlueScreenView: $_" -ForegroundColor Red; return }
try { Expand-Archive -Path $ZipPath -DestinationPath $ExtractPath -Force } catch { Write-Host "Error al extraer BlueScreenView: $_" -ForegroundColor Red; return }
$ExePath = Join-Path $ExtractPath "BlueScreenView.exe"
if (Test-Path -Path $ExePath) { Start-Process -FilePath $ExePath } else { Write-Host "No se encontro BlueScreenView.exe." -ForegroundColor Red }
`,
            'battery-status': `
Write-Host "Generando informe de bateria..." -ForegroundColor Yellow
$batteryReportPath = "$env:USERPROFILE\\Desktop\\battery_report.html"
powercfg /batteryreport /output "$batteryReportPath"
if (Test-Path $batteryReportPath) {
    Start-Process $batteryReportPath
    Write-Host "Informe de bateria generado en $batteryReportPath" -ForegroundColor Green
} else {
    Write-Host "No se pudo generar el informe de bateria." -ForegroundColor Red
}

Write-Host "Abriendo BatteryInfoView..." -ForegroundColor Yellow
$url = "https://www.nirsoft.net/utils/batteryinfoview.zip"
$outputPath = Join-Path $env:TEMP "BatteryInfoView.zip"
$extractPath = Join-Path $env:TEMP "BatteryInfoView"
try {
    Invoke-WebRequest -Uri $url -OutFile $outputPath
} catch {
    Write-Host "Error al descargar BatteryInfoView: $_" -ForegroundColor Red
    return
}
try {
    Expand-Archive -Path $outputPath -DestinationPath $extractPath -Force
} catch {
    Write-Host "Error al extraer BatteryInfoView: $_" -ForegroundColor Red
    return
}
$exePath = Join-Path $extractPath "BatteryInfoView.exe"
if (Test-Path -Path $exePath) {
    Start-Process -FilePath $exePath
} else {
    Write-Host "No se encontro BatteryInfoView.exe." -ForegroundColor Red
}
`,
            'driver-info': `Get-WmiObject -Query "SELECT * FROM Win32_SystemDriver" | Out-File -FilePath "$env:USERPROFILE\\Desktop\\drivers.txt"; Start-Process "devmgmt.msc"`,
            'repair-network': `netsh winsock reset; netsh int ip reset; ipconfig /release; ipconfig /renew; ipconfig /flushdns`,
            'cleanup-temp-files': `
try {
    Write-Host "Limpiando archivos temporales..." -ForegroundColor Cyan
    $userTempPath = $env:TEMP
    $windowsTempPath = "C:\\Windows\\Temp"
    $totalDeleted = 0
    
    function Clean-Folder {
        param($path)
        $items = Get-ChildItem -Path $path -Recurse -Force -ErrorAction SilentlyContinue
        foreach ($item in $items) {
            try {
                Remove-Item $item.FullName -Recurse -Force -ErrorAction Stop
                $script:totalDeleted++
            } catch {
                Write-Warning "No se pudo eliminar: $($item.FullName)"
            }
        }
    }
    
    Clean-Folder -path $userTempPath
    Clean-Folder -path $windowsTempPath

    Write-Host "Limpieza completada. Se eliminaron $script:totalDeleted archivos/carpetas." -ForegroundColor Green
} catch {
    Write-Error "Ocurrió un error durante la limpieza: $_"
}
`,
            'cleanup-optimize-ram': `
$zipUrl = "https://download.sysinternals.com/files/RAMMap.zip"
$downloadPath = "$env:TEMP\\RAMMap.zip"
$extractPath = "$env:TEMP\\RAMMap"
try { Invoke-WebRequest -Uri $zipUrl -OutFile $downloadPath } catch { Write-Host "Error al descargar RAMMap: $_" -ForegroundColor Red; return }
try { Expand-Archive -Path $downloadPath -DestinationPath $extractPath -Force } catch { Write-Host "Error al descomprimir RAMMap: $_" -ForegroundColor Red; return }
$executablePath = Join-Path $extractPath "RAMMap.exe"
if (Test-Path -Path $executablePath) { Start-Process -FilePath $executablePath } else { Write-Host "No se encontro RAMMap.exe." -ForegroundColor Red }
`,
            'find-drivers': `
# 1. VERIFICACIÓN DE PERMISOS
Write-Host "Verificando permisos de administrador..." -ForegroundColor Yellow
if (-NOT ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {
    Write-Warning "Este script necesita ser ejecutado con privilegios de Administrador."
    Start-Sleep -Seconds 10
    Exit
}
Write-Host "Permisos de administrador confirmados." -ForegroundColor Green

# 2. FUNCIONES DE INSTALACIÓN Y EJECUCIÓN
function Ensure-Winget {
    if (-not (Get-Command winget -ErrorAction SilentlyContinue)) {
        Write-Host "Winget no encontrado. Intentando instalarlo..." -ForegroundColor Cyan
        try {
            $wingetUrl = "https://github.com/microsoft/winget-cli/releases/latest/download/Microsoft.DesktopAppInstaller_8wekyb3d8bbwe.msixbundle"
            $wingetInstaller = Join-Path $env:TEMP "winget.msixbundle"
            Invoke-WebRequest -Uri $wingetUrl -OutFile $wingetInstaller -UseBasicParsing
            Add-AppxPackage -Path $wingetInstaller
            Write-Host "Winget instalado correctamente." -ForegroundColor Green
        } catch {
            Write-Error "Falló la instalación de Winget: $($_.Exception.Message)"
            return $false
        }
    }
    return $true
}

function Ensure-Chocolatey {
    if (-not (Get-Command choco -ErrorAction SilentlyContinue)) {
        Write-Host "Chocolatey no encontrado. Intentando instalarlo..." -ForegroundColor Cyan
        try {
            Set-ExecutionPolicy Bypass -Scope Process -Force;
            [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072;
            iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
            Write-Host "Chocolatey instalado correctamente." -ForegroundColor Green
        } catch {
            Write-Error "Falló la instalación de Chocolatey: $($_.Exception.Message)"
            return $false
        }
    }
    return $true
}

function Start-Application {
    param($path, $name)
    Write-Host "Iniciando ''$name''..." -ForegroundColor Yellow
    Start-Process -FilePath $path
    Write-Host "¡Proceso completado!" -ForegroundColor Green
    Write-Host "Script finalizado."
    Start-Sleep -Seconds 10
    Exit
}

# 3. DETECTAR EL FABRICANTE DEL EQUIPO
try {
    $fabricante = (Get-CimInstance -ClassName Win32_ComputerSystem).Manufacturer
    Write-Host "Fabricante detectado: $fabricante" -ForegroundColor Cyan
}
catch {
    Write-Error "No se pudo detectar el fabricante del equipo."
    Start-Sleep -Seconds 10
    Exit
}

# 4. LÓGICA PRINCIPAL BASADA EN EL FABRICANTE
$appExePath = ""
switch ($fabricante.Trim().ToLower()) {
    { $_ -like "*dell*" } {
        $appName = "Dell Command | Update"
        $appExePath = "C:\\Program Files\\Dell\\CommandUpdate\\DCU.Client.Gui.exe"
        $wingetId = "Dell.CommandUpdate"
        $chocoId = "dell-command-update"
    }
    { $_ -like "*hp*" -or $_ -like "*hewlett-packard*" } {
        $appName = "HP Image Assistant"
        $appExePath = "C:\\Program Files (x86)\\HP\\Image Assistant\\HPImageAssistant.exe"
        $wingetId = "HP.ImageAssistant"
        $chocoId = "hp-image-assistant-client" # Se mantiene por si acaso, pero no se usará.
    }
    { $_ -like "*lenovo*" } {
        $appName = "Lenovo System Update"
        $appExePath = "C:\\Program Files (x86)\\Lenovo\\System Update\\tvsu.exe"
        $wingetId = "Lenovo.SystemUpdate"
        $chocoId = "lenovo-system-update"
    }
    default {
        Write-Warning "Fabricante ''$fabricante'' no soportado."
        Start-Sleep -Seconds 10
        Exit
    }
}

# 5. PROCESO DE INSTALACIÓN Y EJECUCIÓN
try {
    # Si ya está instalado, ejecutar y salir.
    if (Test-Path $appExePath) {
        Write-Host "''$appName'' ya se encuentra instalado." -ForegroundColor Green
        Start-Application -path $appExePath -name $appName
    }

    Write-Host "''$appName'' no está instalado. Iniciando proceso de instalación..." -ForegroundColor Yellow

    # --- Intento 1: Winget (Preferido) ---
    if (Ensure-Winget) {
        Write-Host "Intentando instalar con Winget..." -ForegroundColor Cyan
        winget source update | Out-Null
        winget install --id $wingetId -e --accept-package-agreements --accept-source-agreements
        Write-Host "Esperando 15 segundos para que finalice la instalación..."
        Start-Sleep -Seconds 15
        if (Test-Path $appExePath) {
            Write-Host "Instalación con Winget exitosa." -ForegroundColor Green
            Start-Application -path $appExePath -name $appName
        }
    }

    # --- Intento 2: Chocolatey (Respaldo, excepto para HP) ---
    if ($fabricante.Trim().ToLower() -notlike "*hp*") {
        if (Ensure-Chocolatey) {
            Write-Host "Intentando instalar con Chocolatey..." -ForegroundColor Cyan
            choco install $chocoId -y
            Write-Host "Esperando 15 segundos para que finalice la instalación..."
            Start-Sleep -Seconds 15
            if (Test-Path $appExePath) {
                Write-Host "Instalación con Chocolatey exitosa." -ForegroundColor Green
                Start-Application -path $appExePath -name $appName
            }
        }
    }

    # --- Intento 3: Descarga Manual (Último recurso) ---
    Write-Host "Los métodos automáticos fallaron. Intentando descarga manual..." -ForegroundColor Cyan
    $downloadUrl = ""
    $installerName = ""
    $installArgs = ""
    
    if ($fabricante.Trim().ToLower() -like "*hp*") {
        $downloadUrl = "https://hpia.hpcloud.hp.com/downloads/hpia/hp-hpia-5.3.2.exe"
        $installerName = "HPIA_Extractor.exe"
        $installArgs = "/s"
    } elseif ($fabricante.Trim().ToLower() -like "*lenovo*") {
        $downloadUrl = "https://download.lenovo.com/pccbbs/thinkvantage_en/system_update_5.08.02.25.exe"
        $installerName = "LenovoSystemUpdate.exe"
        $installArgs = "/VERYSILENT /SUPPRESSMSGBOXES /NORESTART"
    }

    if ($downloadUrl) {
        $installerPath = Join-Path $env:TEMP $installerName
        Invoke-WebRequest -Uri $downloadUrl -OutFile $installerPath
        Write-Host "Instalando con argumentos: $installArgs" -ForegroundColor Gray
        Start-Process -FilePath $installerPath -ArgumentList $installArgs -Wait
        Write-Host "Esperando 15 segundos para que finalice la instalación..."
        Start-Sleep -Seconds 15

        # Lógica especial para HP: Buscar el ejecutable en C:\\SWSetup
        if ($fabricante.Trim().ToLower() -like "*hp*") {
            Write-Host "Buscando el ejecutable de HP Image Assistant en C:\\SWSetup..."
            $searchPath = "C:\\SWSetup"
            if (Test-Path $searchPath) {
                $hpiaExecutable = Get-ChildItem -Path $searchPath -Recurse -Filter "HPImageAssistant.exe" | Select-Object -First 1
                if ($hpiaExecutable) {
                    $appExePath = $hpiaExecutable.FullName # Ruta encontrada dinámicamente
                    Write-Host "Ejecutable encontrado en: $appExePath" -ForegroundColor Green
                }
            }
        }

        if (Test-Path $appExePath) {
            Write-Host "Instalación manual exitosa." -ForegroundColor Green
            Start-Application -path $appExePath -name $appName
        }
    }
    
    # Si el script llega hasta aquí, significa que todo falló.
    Write-Error "Todos los métodos de instalación fallaron para ''$appName''."
    Start-Sleep 10
    Exit
}
catch {
    Write-Error "Ocurrió un error inesperado: $($_.Exception.Message)"
}

Write-Host "Script finalizado."
Start-Sleep -Seconds 10
`,
            'winutil': `iex ((New-Object System.Net.WebClient).DownloadString("https://christitus.com/win"))`,
            'install-winget': `Write-Warning "La instalación automática de Winget ha sido desactivada. Por favor, instálelo desde la Microsoft Store." ; Start-Process "ms-windows-store://pdp/?productid=9NBLGGH4NNS1"`,
            'activate-windows': `$key = (Get-WmiObject SoftwareLicensingService).OA3xOriginalProductKey; if ($key) { slmgr.vbs /ipk $key; slmgr.vbs /ato } else { Write-Error "No se encontró una clave de producto en el firmware." }`,
            'update-windows': `Start-Process "ms-settings:windowsupdate"`,
            'system-properties': `control.exe sysdm.cpl`,
            'disable-transparency': `Set-ItemProperty -Path "HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize" -Name "EnableTransparency" -Value 0`,
            'reboot-bios': `shutdown /r /fw /t 1`,
            'recovery-env': `shutdown /r /o /f /t 00`,
            'update-apps': `winget upgrade --all --include-unknown --accept-package-agreements --accept-source-agreements`,
            'home-control-panel': `Start-Process "control.exe"`,
            'home-quick-diagnostic': `Get-CimInstance Win32_ComputerSystem; Get-CimInstance Win32_Processor | Select-Object Name, NumberOfCores; Get-CimInstance Win32_PhysicalMemory | Measure-Object -Property Capacity -Sum; Get-PSDrive C`,
            'home-windows-settings': `Start-Process "ms-settings:"`,
            'home-file-explorer': `Start-Process "explorer.exe"`,
            'home-powershell-console': `Start-Process powershell.exe`,
            'home-system-info-app': `Start-Process "msinfo32.exe"`,
            'tools-download-windows': `Start-Process "https://brandonsepulveda.github.io/descargawindows.html"`,
            'tools-install-windows': `iex ((New-Object System.Net.WebClient).DownloadString("https://cutt.ly/WinDeploy"))`,
            'tools-optimize-system': `
if (-not (Test-Path "$env:TEMP\\ToolboxBS")) { New-Item -Path "$env:TEMP\\ToolboxBS" -ItemType Directory -Force | Out-Null }
Invoke-WebRequest -Uri "https://raw.githubusercontent.com/BrandonSepulveda/ToolboxBS/refs/heads/main/procesos/performance.bat" -OutFile "$env:TEMP\\ToolboxBS\\performance.bat"
Start-Process -FilePath "cmd.exe" -ArgumentList "/c", "$env:TEMP\\ToolboxBS\\performance.bat"
`,
            'tools-windows-repair': `sfc /scannow; DISM /Online /Cleanup-image /Restorehealth`,
            'tools-task-manager': `Start-Process "taskmgr.exe"`,
            'tools-device-manager': `Start-Process "devmgmt.msc"`,
            'tools-windows-services': `Start-Process "services.msc"`,
            'tools-disk-cleanup': `Start-Process "cleanmgr.exe"`,
            'tools-registry-editor': `Start-Process "regedit.exe"`,
            'tools-winget-cli': `Start-Process powershell.exe -ArgumentList "-NoExit", "-Command", "winget"`,
            'tools-check-updates': `Start-Process "ms-settings:windowsupdate"`
        };

        // Función para alternar la selección de un elemento
        function toggleSelection(element, toolId, category) {
            const checkbox = element.querySelector('.tool-checkbox');
            const isSelected = element.classList.contains('selected');
            
            if (isSelected) {
                element.classList.remove('selected');
                if (checkbox) checkbox.classList.remove('checked');
                selectedTools[category] = selectedTools[category].filter(id => id !== toolId);
            } else {
                element.classList.add('selected');
                if (checkbox) checkbox.classList.add('checked');
                selectedTools[category].push(toolId);
            }
            
            updateGlobalFloatingButton(); // Update global button on any selection change
        }

        // Función para actualizar el estado del botón de ejecución y el contador
        function updateGlobalFloatingButton() {
            let totalSelected = 0;
            for (const category in selectedTools) {
                totalSelected += selectedTools[category].length;
            }
            
            const fabButton = document.getElementById('fabButton');
            const fabCount = document.getElementById('fabCount');
            const fabText = document.getElementById('fabText');

            fabButton.disabled = totalSelected === 0;
            
            if (totalSelected > 0) {
                fabCount.textContent = totalSelected;
                fabButton.title = 'Generar Script (' + totalSelected + ' seleccionados)';
                fabText.style.display = 'none';
                fabCount.style.transform = 'scale(1)';
            } else {
                fabButton.title = 'Generar Script';
                fabText.style.display = 'block';
                fabCount.style.transform = 'scale(0)';
            }
        }

        // Función para limpiar todas las selecciones de una categoría específica
        function clearSelections(category) {
            selectedTools[category] = [];
            const modalId = getModalIdFromCategory(category);
            const modal = document.getElementById(modalId);
            if (modal) {
                const items = modal.querySelectorAll('.tool-item');
                items.forEach(item => {
                    item.classList.remove('selected');
                    const checkbox = item.querySelector('.tool-checkbox');
                    if (checkbox) checkbox.classList.remove('checked');
                });
            }
            updateGlobalFloatingButton();
        }

        // Función para obtener el ID del modal a partir de la categoría
        function getModalIdFromCategory(category) {
            switch(category) {
                case 'info': return 'info-modal';
                case 'repair': return 'repair-modal';
                case 'repairCleanup': return 'cleanup-sub-modal';
                case 'tweaks': return 'tweaks-modal';
                case 'home': return 'home-modal';
                case 'tools': return 'tools-modal';
                case 'about': return 'about-modal';
                default: return '';
            }
        }

        // Función para mostrar el código generado y descargar ZIP
        function showGeneratedCode() {
            const allCommands = [];
            let hasSelections = false;
            
            // Define the order of execution
            const categoryOrder = ['home', 'repair', 'repairCleanup', 'tweaks', 'tools', 'info'];

            categoryOrder.forEach(category => {
                if (selectedTools[category]) {
                    for (const toolId of selectedTools[category]) {
                        const command = powershellCommands[toolId];
                        if (command) {
                            const toolItem = document.querySelector(`.tool-item[onclick*="'${toolId}'"]`);
                            const toolText = toolItem ? toolItem.querySelector('.tool-item-text').textContent.trim() : `Tarea`;
                            allCommands.push({ text: toolText, script: command });
                            hasSelections = true;
                        }
                    }
                }
            });

            if (!hasSelections) {
                showMessageBox("Por favor, selecciona al menos una función para generar el script.");
                return;
            }

            let ps1Header = `<#
    .SYNOPSIS
        Script de automatización generado por ToolboxBS.

    .DESCRIPTION
        Este script ejecuta una serie de tareas de mantenimiento y optimización seleccionadas
        a través de la interfaz web de ToolboxBS.

    .WARNING
        Este script realiza cambios en el sistema. Ha sido generado basado en tus selecciones.
        Ejecútalo únicamente si confías en la fuente (ToolboxBS) y entiendes las tareas que se realizarán.
        Los programas antivirus pueden marcar este archivo como potencialmente peligroso debido a las
        acciones administrativas que realiza. Esto es, en la mayoría de los casos, un falso positivo.
#>\n\n`;
            
            let ps1Content = ps1Header + `# =================================================================\n`;
            ps1Content += `# INICIO DEL SCRIPT GENERADO POR TOOLBOXBS\n`;
            ps1Content += `# =================================================================\n\n`;

            allCommands.forEach((cmd, index) => {
                ps1Content += `Write-Host ""\n`;
                ps1Content += `Write-Host "=================================================================" -ForegroundColor Green\n`;
                ps1Content += `Write-Host "        EJECUTANDO TAREA ${index + 1}/${allCommands.length}: ${cmd.text}" -ForegroundColor Yellow\n`;
                ps1Content += `Write-Host "=================================================================" -ForegroundColor Green\n\n`;
                ps1Content += `${cmd.script.trim()}\n\n`;
            });
            ps1Content += `Write-Host "Todas las tareas han finalizado." -ForegroundColor Green\n`;
            ps1Content += `Read-Host "Presiona ENTER para cerrar la ventana."\n`;

            let batContent = `@echo off
REM =================================================================
REM LANZADOR PARA EL SCRIPT DE TOOLBOXBS (CON AUTODESTRUCCIÓN)
REM =================================================================
REM Este archivo .bat está diseñado para ejecutar el script 'ToolboxBS_Script.ps1'
REM con la política de ejecución correcta y luego se limpiará a sí mismo.
REM
REM ADVERTENCIA DE SEGURIDAD:
REM Su navegador o antivirus puede marcar este archivo como peligroso.
REM Esto es normal para scripts que realizan tareas administrativas.
REM Ejecútelo solo si confía en la fuente.
REM
REM Para ejecutar, haga clic derecho sobre este archivo y seleccione
REM "Ejecutar como administrador".
REM =================================================================

chcp 65001 > nul
echo Ejecutando el script de PowerShell...
powershell.exe -NoProfile -ExecutionPolicy Bypass -File "%~dp0ToolboxBS_Script.ps1"

echo.
echo Creando script de limpieza temporal...

REM Crea un script de limpieza en la carpeta temporal del sistema.
>"%TEMP%\\cleanup_toolbox.bat" echo @echo off
>>"%TEMP%\\cleanup_toolbox.bat" echo echo.
>>"%TEMP%\\cleanup_toolbox.bat" echo echo Limpiando archivos de ToolboxBS...
>>"%TEMP%\\cleanup_toolbox.bat" echo timeout /t 4 /nobreak > nul
>>"%TEMP%\\cleanup_toolbox.bat" echo rmdir /s /q "%~dp0"
>>"%TEMP%\\cleanup_toolbox.bat" echo echo Limpieza completada. La ventana se cerrara en 2 segundos.
>>"%TEMP%\\cleanup_toolbox.bat" echo timeout /t 2 /nobreak > nul
>>"%TEMP%\\cleanup_toolbox.bat" echo del "%%~f0"

echo Lanzando limpieza en segundo plano y saliendo...
start "" /b cmd /c "%TEMP%\\cleanup_toolbox.bat"
`;

            currentPs1Content = ps1Content;
            currentBatContent = batContent;

            document.getElementById('codeContent').textContent = ps1Content;
            openModal('codeDisplayBox');
        }

        function copyCodeFromDisplay() {
            const codeContent = document.getElementById('codeContent').textContent;
            navigator.clipboard.writeText(codeContent).then(() => {
                showMessageBox("¡Código copiado al portapapeles!");
            }, (err) => {
                console.error('Error al copiar: ', err);
                showMessageBox("Error al copiar el código.");
            });
        }

        async function downloadZipFromDisplay() {
            try {
                const zip = new JSZip();
                zip.file("ToolboxBS_Script.ps1", currentPs1Content);
                zip.file("EJECUTAR_ESTE_ARCHIVO.bat", currentBatContent);
                
                const zipBlob = await zip.generateAsync({ type: "blob" });

                const url = URL.createObjectURL(zipBlob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `ToolboxBS_Script.zip`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                closeModal('codeDisplayBox');

                showMessageBox("<h3 style='color: var(--accent-color);'>¡ZIP generado!</h3><p style='text-align: left; margin-bottom: 15px;'><strong>ADVERTENCIA DE SEGURIDAD:</strong><br>Tu navegador o antivirus podría marcar el archivo descargado como peligroso. Esto es normal para herramientas de sistema.</p><p style='text-align: left;'><strong>Pasos para ejecutar:</strong><br>1. Extrae el contenido del archivo <strong>ToolboxBS_Script.zip</strong>.<br>2. Dentro de la carpeta, haz clic derecho en <strong>EJECUTAR_ESTE_ARCHIVO.bat</strong>.<br>3. Selecciona '<strong>Ejecutar como administrador</strong>'.</p>");

            } catch (error) {
                console.error("Error al generar el ZIP:", error);
                showMessageBox("Ocurrió un error al generar el archivo ZIP.");
            }

            // Limpiar selecciones
            for (const category in selectedTools) {
                clearSelections(category);
            }
            updateGlobalFloatingButton();
        }

        // Funciones para abrir y cerrar modales
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) modal.style.display = 'flex';
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if(modal) modal.style.display = 'none';
        }

        // Funciones de navegación
        function openExternalLink(url) {
            window.open(url, '_blank');
        }

        // Funciones para el Message Box personalizado
        function showMessageBox(message) {
            const messageBox = document.getElementById('messageBox');
            const messageText = document.getElementById('messageText');
            messageText.innerHTML = message;
            messageBox.style.display = 'flex';
        }

        function hideMessageBox() {
            document.getElementById('messageBox').style.display = 'none';
        }

        // --- NUEVA LÓGICA PARA EL SELECTOR DE COLOR ---
        function setupColorPicker() {
            const colorPicker = document.getElementById('colorPicker');
            const root = document.documentElement;

            // Función para actualizar el color
            const updateAccentColor = (color) => {
                root.style.setProperty('--accent-color', color);
                
                // Generar una versión más oscura para el hover
                const darkColor = pSBC(-0.2, color);
                root.style.setProperty('--accent-dark', darkColor);

                // Generar una versión transparente para sombras y brillos
                const transColor = hexToRgba(color, 0.15);
                root.style.setProperty('--accent-color-trans', transColor);
            };
            
            // Evento para cuando se cambia el color
            colorPicker.addEventListener('input', (e) => {
                updateAccentColor(e.target.value);
            });

            // Establecer el color inicial al cargar la página
            updateAccentColor(colorPicker.value);
        }

        // Función para aclarar/oscurecer colores (de https://stackoverflow.com/a/13532993)
        const pSBC=(p,c0,c1,l)=>{
            let r,g,b,P,f,t,h,i=parseInt,m=Math.round,a=typeof(c1)=="string";
            if(typeof(p)!="number"||p<-1||p>1||typeof(c0)!="string"||(c0[0]!='r'&&c0[0]!='#')||(c1&&!a))return null;
            if(!this.pSBCr)this.pSBCr=(d)=>{
                let n=d.length,x={};
                if(n>9){
                    [r,g,b,a]=d=d.split(","),n=d.length;
                    if(n<3||n>4)return null;
                    x.r=i(r[3]=="a"?r.slice(5):r.slice(4)),x.g=i(g),x.b=i(b),x.a=a?parseFloat(a):-1
                }else{
                    if(n==8||n==6||n<4)return null;
                    if(n<6)d="#"+d[1]+d[1]+d[2]+d[2]+d[3]+d[3]+(n>4?d[4]+d[4]:"");
                    d=i(d.slice(1),16);
                    if(n==9||n==5)x.r=d>>24&255,x.g=d>>16&255,x.b=d>>8&255,x.a=m((d&255)/0.255)/1000;
                    else x.r=d>>16,x.g=d>>8&255,x.b=d&255,x.a=-1
                }return x};
            h=c0.length>9,h=a?c1.length>9?true:c1=="c"?!h:false:h,f=this.pSBCr(c0),P=p<0,t=c1&&c1!="c"?this.pSBCr(c1):P?{r:0,g:0,b:0,a:-1}:{r:255,g:255,b:255,a:-1},p=P?p*-1:p,P=1-p;
            if(!f||!t)return null;
            if(l)r=m(P*f.r+p*t.r),g=m(P*f.g+p*t.g),b=m(P*f.b+p*t.b);
            else r=m((P*f.r**2+p*t.r**2)**0.5),g=m((P*f.g**2+p*t.g**2)**0.5),b=m((P*f.b**2+p*t.b**2)**0.5);
            a=f.a,t=t.a,f=a>=0||t>=0,a=f?a<0?t:t<0?a:a*P+t*p:0;
            if(h)return"rgb"+(f?"a(":"(")+r+","+g+","+b+(f?","+m(a*1000)/1000:"")+")";
            else return"#"+(4294967296+r*16777216+g*65536+b*256+(f?m(a*255):0)).toString(16).slice(1,f?undefined:-2)
        }

        // Función para convertir HEX a RGBA
        function hexToRgba(hex, alpha) {
            let r = 0, g = 0, b = 0;
            if (hex.length == 4) {
                r = "0x" + hex[1] + hex[1];
                g = "0x" + hex[2] + hex[2];
                b = "0x" + hex[3] + hex[3];
            } else if (hex.length == 7) {
                r = "0x" + hex[1] + hex[2];
                g = "0x" + hex[3] + hex[4];
                b = "0x" + hex[5] + hex[6];
            }
            return `rgba(${+r},${+g},${+b},${alpha})`;
        }


        // Inicializar todo al cargar la página
        document.addEventListener('DOMContentLoaded', () => {
            updateGlobalFloatingButton();
            setupColorPicker();
        });

        // ==================================================================
        // FIN DE LA LÓGICA DE LA APLICACIÓN
        // ==================================================================
    </script>
</body>
</html>
